<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SICO MIX • Управління рецептами фарб</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icons/favicon.ico">
    <style>
        /* Видаляємо mobile-nav на десктопах */
        @media (min-width: 993px) {
            .mobile-nav {
                display: none !important;
            }
        }
        
        /* Для мобільних пристроїв */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .container {
                margin-left: 0 !important;
            }
        }
        
        /* Для десктопів */
        @media (min-width: 993px) {
            .sidebar {
                transform: translateX(0) !important;
            }
            
            .container {
                margin-left: 280px !important;
            }
            
            .desktop-nav .menu-toggle {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Navigation (тільки для мобільних) -->
    <div class="mobile-nav">
        <button class="menu-toggle" id="mobileMenuToggle">
            <i class="fas fa-bars"></i>
        </button>
        <div class="mobile-nav-title">
            <i class="fas fa-palette"></i> SICO MIX
        </div>
    </div>

    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo-container">
                <h1><i class="fas fa-palette"></i> SICO MIX</h1>
                <p>Система управління рецептами фарб</p>
            </div>
            <button class="close-sidebar" id="closeSidebar">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <h3 class="nav-title">Головне меню</h3>
        <ul class="nav-menu">
            <li class="nav-item">
                <a class="nav-link active" data-page="home">
                    <i class="fas fa-home"></i>
                    <span data-i18n="home">Головна</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-page="new-recipe">
                    <i class="fas fa-plus-circle"></i>
                    <span data-i18n="new_recipe">Новий рецепт</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-page="recipes">
                    <i class="fas fa-book-open"></i>
                    <span data-i18n="recipes">Рецепти</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-page="catalog">
                    <i class="fas fa-layer-group"></i>
                    <span data-i18n="catalog">Каталог фарб</span>
                </a>
            </li>
        </ul>

        <h3 class="nav-title">Імпорт/Експорт</h3>
        <ul class="nav-menu">
            <li class="nav-item">
                <a class="nav-link" data-page="import">
                    <i class="fas fa-file-import"></i>
                    <span data-i18n="import">Імпорт</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-page="export">
                    <i class="fas fa-file-export"></i>
                    <span data-i18n="export">Експорт</span>
                </a>
            </li>
        </ul>

        <h3 class="nav-title">Налаштування</h3>
        <ul class="nav-menu">
            <li class="nav-item">
                <a class="nav-link" data-page="settings">
                    <i class="fas fa-sliders-h"></i>
                    <span data-i18n="settings">Налаштування</span>
                </a>
            </li>
        </ul>

        <div style="margin-top: 30px; padding: 20px; background: var(--light); border-radius: var(--border-radius);">
            <div class="paint-count">
                <i class="fas fa-paint-brush"></i>
                <span id="totalPaints">0</span> <span data-i18n="paints_in_catalog">фарб у каталозі</span>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="container" id="mainContainer">
        <!-- Header -->
        <header class="header">
            <div class="desktop-nav">
                <button class="menu-toggle" id="desktopMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo-container">
                    <h1><i class="fas fa-palette"></i> SICO MIX</h1>
                </div>
            </div>
            <div class="paint-count">
                <i class="fas fa-paint-brush"></i>
                <span id="headerPaintCount">0</span> <span data-i18n="paints_in_catalog">фарб у каталозі</span>
            </div>
        </header>

        <!-- Page Content -->
        <main id="page-content">
            <!-- Home Page -->
            <div class="page-content active" id="home-page">
                <!-- Вміст головної сторінки -->
            </div>

            <!-- New Recipe Page -->
            <div class="page-content" id="new-recipe-page">
                <!-- Вміст новий рецепт -->
            </div>

            <!-- Recipes Page -->
            <div class="page-content" id="recipes-page">
                <!-- Вміст рецепти -->
            </div>

            <!-- Catalog Page -->
            <div class="page-content" id="catalog-page">
                <!-- Вміст каталог -->
            </div>

            <!-- Import Page -->
            <div class="page-content" id="import-page">
                <!-- Вміст імпорт -->
            </div>

            <!-- Export Page -->
            <div class="page-content" id="export-page">
                <!-- Вміст експорт -->
            </div>

            <!-- Settings Page -->
            <div class="page-content" id="settings-page">
                <h2 class="page-title" data-i18n="settings">Налаштування</h2>
                <p class="page-description" data-i18n="settings_desc">Налаштуйте систему SICO MIX за вашими потребами</p>

                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-cog"></i>
                        <span data-i18n="general_settings">Загальні налаштування</span>
                    </h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" data-i18n="interface_language">Мова інтерфейсу</label>
                            <select class="form-select" id="languageSelect">
                                <option value="uk">Українська</option>
                                <option value="en">English</option>
                                <option value="pl">Polski</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" data-i18n="measurement_units">Одиниці вимірювання</label>
                            <select class="form-select" id="unitsSelect">
                                <option value="grams">Грами (г)</option>
                                <option value="percent">Відсотки (%)</option>
                                <option value="ml">Мілілітри (мл)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" data-i18n="auto_save">Автоматичне збереження</label>
                        <div>
                            <label style="display: block; margin-bottom: 10px;">
                                <input type="checkbox" id="autoSaveCheckbox"> <span data-i18n="auto_save_changes">Автоматично зберігати зміни</span>
                            </label>
                            <label style="display: block; margin-bottom: 10px;">
                                <input type="checkbox" id="backupCheckbox"> <span data-i18n="create_backups">Створювати резервні копії</span>
                            </label>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-primary" id="saveSettingsBtn">
                            <i class="fas fa-save"></i>
                            <span data-i18n="save_settings">Зберегти налаштування</span>
                        </button>
                        <button class="btn btn-warning" id="resetSettingsBtn">
                            <i class="fas fa-undo"></i>
                            <span data-i18n="reset_defaults">Скинути до стандартних</span>
                        </button>
                        <button class="btn btn-danger" id="clearAllDataBtn">
                            <i class="fas fa-trash"></i>
                            <span data-i18n="clear_all_data">Очистити всі дані</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p>SICO MIX • Версія 2.2 • © 2023 Система управління рецептами фарб</p>
        </footer>
    </div>

    <script>
        // Простий менеджер налаштувань
        const SettingsManager = {
            // Завантажити налаштування
            loadSettings() {
                const settings = JSON.parse(localStorage.getItem('sicoMixSettings')) || {
                    language: 'uk',
                    units: 'grams',
                    autoSave: true,
                    backup: false
                };
                return settings;
            },
            
            // Зберегти налаштування
            saveSettings(settings) {
                localStorage.setItem('sicoMixSettings', JSON.stringify(settings));
            },
            
            // Застосувати налаштування до форми
            applySettings(settings) {
                // Мова
                const languageSelect = document.getElementById('languageSelect');
                if (languageSelect) {
                    languageSelect.value = settings.language;
                }
                
                // Одиниці вимірювання
                const unitsSelect = document.getElementById('unitsSelect');
                if (unitsSelect) {
                    unitsSelect.value = settings.units;
                }
                
                // Автозбереження
                const autoSaveCheckbox = document.getElementById('autoSaveCheckbox');
                if (autoSaveCheckbox) {
                    autoSaveCheckbox.checked = settings.autoSave;
                }
                
                // Резервні копії
                const backupCheckbox = document.getElementById('backupCheckbox');
                if (backupCheckbox) {
                    backupCheckbox.checked = settings.backup;
                }
            },
            
            // Отримати поточні налаштування з форми
            getCurrentSettings() {
                return {
                    language: document.getElementById('languageSelect').value,
                    units: document.getElementById('unitsSelect').value,
                    autoSave: document.getElementById('autoSaveCheckbox').checked,
                    backup: document.getElementById('backupCheckbox').checked
                };
            }
        };

        // Ініціалізація додатку
        document.addEventListener('DOMContentLoaded', function() {
            // Завантажити налаштування
            const settings = SettingsManager.loadSettings();
            
            // Застосувати налаштування до форми
            SettingsManager.applySettings(settings);
            
            // Застосувати мову
            if (window.SICOMIX && SICOMIX.i18n) {
                SICOMIX.i18n.setLanguage(settings.language);
                SICOMIX.i18n.applyTranslations();
            }
            
            // Елементи DOM
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const desktopMenuToggle = document.getElementById('desktopMenuToggle');
            const closeSidebar = document.getElementById('closeSidebar');
            const sidebar = document.getElementById('sidebar');
            const navLinks = document.querySelectorAll('.nav-link');
            const actionCards = document.querySelectorAll('.action-card');
            const pageContents = document.querySelectorAll('.page-content');
            
            // Перемикач бокової панелі для мобільних
            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', function() {
                    sidebar.classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
            }
            
            // Перемикач бокової панелі для десктопів
            if (desktopMenuToggle) {
                desktopMenuToggle.addEventListener('click', function() {
                    sidebar.classList.add('active');
                });
            }
            
            // Закриття бокової панелі
            if (closeSidebar) {
                closeSidebar.addEventListener('click', function() {
                    sidebar.classList.remove('active');
                    document.body.style.overflow = 'auto';
                });
            }
            
            // Функція перемикання сторінок
            function switchPage(pageId) {
                // Приховати всі сторінки
                pageContents.forEach(page => {
                    page.classList.remove('active');
                });
                
                // Показати обрану сторінку
                const selectedPage = document.getElementById(`${pageId}-page`);
                if (selectedPage) {
                    selectedPage.classList.add('active');
                }
                
                // Оновити активне посилання в навігації
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-page') === pageId) {
                        link.classList.add('active');
                    }
                });
                
                // Закрити бокову панель на мобільних пристроях
                if (window.innerWidth < 993) {
                    sidebar.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            }
            
            // Обробники для навігаційних посилань
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    switchPage(pageId);
                });
            });
            
            // Обробники для карток дій
            actionCards.forEach(card => {
                card.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    switchPage(pageId);
                });
            });
            
            // Збереження налаштувань
            const saveSettingsBtn = document.getElementById('saveSettingsBtn');
            if (saveSettingsBtn) {
                saveSettingsBtn.addEventListener('click', function() {
                    // Отримати поточні налаштування
                    const currentSettings = SettingsManager.getCurrentSettings();
                    
                    // Зберегти налаштування
                    SettingsManager.saveSettings(currentSettings);
                    
                    // Застосувати нову мову
                    if (window.SICOMIX && SICOMIX.i18n) {
                        SICOMIX.i18n.setLanguage(currentSettings.language);
                        SICOMIX.i18n.applyTranslations();
                    }
                    
                    // Показати сповіщення
                    alert('Налаштування збережено!');
                });
            }
            
            // Скидання налаштувань
            const resetSettingsBtn = document.getElementById('resetSettingsBtn');
            if (resetSettingsBtn) {
                resetSettingsBtn.addEventListener('click', function() {
                    if (confirm('Скинути налаштування до стандартних?')) {
                        const defaultSettings = {
                            language: 'uk',
                            units: 'grams',
                            autoSave: true,
                            backup: false
                        };
                        
                        SettingsManager.saveSettings(defaultSettings);
                        SettingsManager.applySettings(defaultSettings);
                        
                        if (window.SICOMIX && SICOMIX.i18n) {
                            SICOMIX.i18n.setLanguage('uk');
                            SICOMIX.i18n.applyTranslations();
                        }
                        
                        alert('Налаштування скинуті!');
                    }
                });
            }
            
            // Очищення всіх даних
            const clearAllDataBtn = document.getElementById('clearAllDataBtn');
            if (clearAllDataBtn) {
                clearAllDataBtn.addEventListener('click', function() {
                    if (confirm('УВАГА! Це видалить всі ваші рецепти та фарби. Продовжити?')) {
                        // Очистити localStorage
                        localStorage.removeItem('sicoMixRecipes');
                        localStorage.removeItem('sicoMixPaints');
                        localStorage.removeItem('sicoMixSettings');
                        
                        // Перезавантажити сторінку
                        location.reload();
                    }
                });
            }
            
            // Закриття бокової панелі при кліку поза нею (для мобільних)
            document.addEventListener('click', function(e) {
                if (window.innerWidth < 993 && 
                    sidebar.classList.contains('active') &&
                    !sidebar.contains(e.target) && 
                    !mobileMenuToggle.contains(e.target)) {
                    sidebar.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Оновлення кількості фарб (приклад)
            function updatePaintCount() {
                const paints = JSON.parse(localStorage.getItem('sicoMixPaints')) || [];
                const count = paints.length || 10; // Приклад: 10 фарб за замовчуванням
                
                document.getElementById('totalPaints').textContent = count;
                document.getElementById('headerPaintCount').textContent = count;
            }
            
            // Ініціалізація
            updatePaintCount();
            
            // Адаптація при зміні розміру вікна
            window.addEventListener('resize', function() {
                if (window.innerWidth >= 993) {
                    sidebar.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Показати головну сторінку
            switchPage('home');
        });
    </script>
    
    <script src="js/data-colors.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        // Реєстрація Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('js/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker зареєстрований:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Помилка реєстрації Service Worker:', error);
                    });
            });
        }
    </script>
</body>
</html>
